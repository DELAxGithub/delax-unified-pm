# 進捗引き継ぎ - 2025年7月22日（更新）

## 今回完了した作業

### 制作チーム用ダッシュボード機能の実装
- ✅ データベース設計と新規テーブル作成（team_dashboard）
- ✅ サイドバー下部にチーム共有ダッシュボードを統合
- ✅ 4つのウィジェット実装：
  - **メモウィジェット**: チーム共有メモ（インライン編集対応）
  - **クイックリンクウィジェット**: よく使うURL管理
  - **タスクウィジェット**: チェックボックス付きTO-DOリスト
  - **スケジュールウィジェット**: 今週の重要予定を自動表示
- ✅ 誰でも編集可能なチーム共有機能
- ✅ 折りたたみ可能なウィジェット表示

### ゲストアカウント機能の実装
- ✅ Supabase匿名認証を有効化
- ✅ AuthContextに匿名ログイン機能を追加
- ✅ ログインページに「ゲストとして利用」ボタンを追加
- ✅ パスワード管理の煩雑さを解消

### UI改善とクリーンアップ
- ✅ サイドバーテキストの短縮（「リベラリー進捗すごろく」→「進捗すごろく」）
- ✅ 折り返し問題の解決
- ✅ ヘッダーから不要な「新規番組追加ボタン」を削除
- ✅ UIの整理とバンドルサイズ軽量化

### 実装場所（新規追加）
- `/src/components/dashboard/` - ダッシュボード関連コンポーネント群
- `/src/types/dashboard.ts` - ダッシュボード型定義
- `/src/lib/dashboard.ts` - ダッシュボードAPI関数
- `/src/hooks/useDashboard.ts` - ダッシュボード用カスタムフック
- `/supabase/migrations/20250122_team_dashboard.sql` - ダッシュボード用テーブル

## 前回完了した作業

### 週次レビュー機能のSupabase Edge Functions移行
- ✅ Puppeteerによるスクリーンショット機能を削除（パフォーマンス改善）
- ✅ テキストベースのメールテンプレート作成（絵文字付き）
- ✅ Supabase Edge Functionsで週次レビュー機能を実装
- ✅ Edge Functionを本番環境にデプロイ済み
- ✅ Resend APIを使用したメール送信機能

## 次回の継続作業

### 🔴 優先度高：週次レビュー機能の本格稼働
本番環境で週次レビュー機能を稼働させるため、以下の環境変数設定が必要：

#### Supabase Dashboard で設定が必要な環境変数
```bash
# 必須設定
RESEND_API_KEY=re_xxxxxxxxxx  # Resend APIキー（要取得）
REVIEW_EMAIL=h.kodera@gmail.com  # レビュー送信先メール
APP_BASE_URL=https://your-production-url.com  # 本番URL

# オプション
EMAIL_DOMAIN=your-domain.com  # メール送信者ドメイン
SLACK_WEBHOOK_URL=https://hooks.slack.com/...  # Slack通知用（既存？）
```

#### 設定手順
1. [Resend](https://resend.com) でアカウント作成・APIキー取得
2. Supabase Dashboard → Settings → Edge Functions → Environment variables で上記を設定
3. 週次レビューの動作テスト実行

### 🟡 今後の改善案
- 週次レビューのスケジュール自動実行設定（cron job）
- メールテンプレートのデザイン改善
- レビュー内容の充実化（エピソード進捗統計など）

## システムの現在状態

### 稼働中の機能
- ✅ エピソード管理（一覧、詳細、編集）
- ✅ 進捗すごろく（縦型カンバンボード、フィルター付き）
- ✅ カレンダー（ドラッグ&ドロップ、チームイベント対応）
- ✅ チームイベント機能（4種類のイベントタイプ）
- ✅ 制作チーム用ダッシュボード（メモ、リンク、タスク、スケジュール）
- ✅ ゲストアカウントログイン（匿名認証）
- ✅ リアルタイム更新（全画面で即座に反映）
- ✅ JST統一（トロント在住でも日本時間で統一）

### データベース
- エピソードデータ：完全移行済み（programsテーブルは廃止済み）
- カレンダーイベント：正常動作
- チームイベント：正常動作
- チームダッシュボード：新規実装済み

### 技術スタック
- Frontend: React 18 + TypeScript + Vite + Tailwind CSS
- Backend: Supabase（認証、DB、リアルタイム、Edge Functions）
- 本番環境：デプロイ済み、正常稼働中

## 注意事項
- 全ての変更は本番環境に自動デプロイする方針（ユーザー要望）
- programsテーブルは完全に廃止されているため、古いコードを参照しないよう注意
- チームイベントの編集機能は意図的に削除済み（ユーザーフィードバックによる）

## 関連ドキュメント
- `/CLAUDE.md` - プロジェクト全体の説明とコマンド集
- `/supabase/migrations/` - データベーススキーマ変更履歴
- この `progress.md` - 作業進捗の引き継ぎ用

---
*最終更新: 2025年7月22日*
*次回開始時は、この progress.md を最初に確認してから作業を開始してください*